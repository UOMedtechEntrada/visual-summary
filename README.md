# CBME Elentra Visual Summary Module

This is standalone adaptation of a series of dashboards originally developed at the University of Saskatchewan as a research project to visualize resident EPA data [(publication)](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7082472/). This version has been modified to work within the Elentra ecosystem as an auxiliary page (visual summary) that loads along with the existing CBME dashboards in Elentra.

## Getting Started

To get started you will need to have a version of Elentra (1.23 or above) running locally with CBME enabled courses. The visual summary page is an optional feature that needs to be enabled through a database setting (cbme_enable_visual_summary).

Also make sure to have Node JS and npm installed in your local environment from where the project will be built.  

The visual summary page relies on data that is generated by a cron job that runs on all CBME enabled courses. If your local data snapshot doesn't have any data in the `cbme_visual_summary_stats` table you can generate it by triggering the cron `cbme-visual-summary-statistics-generator` manually using the following command in the cron folder after entering Elentra bash. 

```
php cbme-visual-summary-statistics-generator.php --all_cbme_courses
```

### Installing

Install the required npm modules and force install peer dependencies
```
npm install --legacy-peer-deps
```
## Local Development 
First replace the build output path to your `javascript` folder in the Elentra source code in the webpack configuration that can be found in `build-config/webpack.config.js`.

Then run webpack to watch for changes in your local and automatically build and output a new file into the Elentra javascript folder. 
```
npm run start
```

## Creating a build

To create a production build. Run the following command to create a minified version of the source code.

```
npm run build
```
This will output a `visual-summary.js` file into the build folder. That then needs to be manually copied over into the `javascript` folder in the Elentra source code. 

## License

This project is licensed under the MIT License - see the [LICENSE.md](LICENSE.md) file for details