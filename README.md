# CBME Elentra Visual Summary Module

This is standalone adaptation of a series of dashboards originally developed at the University of Saskatchewan as a research project to visualize resident EPA data [(publication)](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7082472/). A user guide for the dashboard suite can be found at [documentation](https://github.com/kiranbandi/cbd-dashboard-ui/blob/visual-summary/documentation/user_guide.pdf).

This version of the Visual Summary dashboard suite has been modified to work within the Elentra ecosystem as an auxiliary page (visual summary) that loads along with the existing CBME dashboards in Elentra. 
This project uses [webpack](https://webpack.js.org/) to build the entire codebase into a single file (visual-summary.js) which is then added to the Elentra code base as an external javscript file.


## Getting Started

To get started you will need to have a version of Elentra (1.23 or above) running locally with CBME enabled courses. The visual summary page is an optional feature that needs to be enabled through a database setting (cbme_enable_visual_summary).

Also make sure to have Node JS and npm installed in your local environment to build the project.  

The visual summary page relies on data that is generated by a cron job that runs on all CBME enabled courses. If your local data snapshot doesn't have any data in the `cbme_visual_summary_stats` table you can generate it by triggering the cron `cbme-visual-summary-statistics-generator` manually using the following command in the cron folder after entering Elentra bash. 

```
php cbme-visual-summary-statistics-generator.php --all_cbme_courses
```

### Installing

Install the required npm modules (the additional flag is to force install certain peer dependencies) 
```
npm install --legacy-peer-deps
```
## Local Development 
In both local development and production builds webpack will output the built `visual-summary.js`file directly into the javascript folder in the elentra-me codebase.      
For this linking between projects to work set the `outputPath` value in the path.config.js file that can be found in the `build-config` folder.
The `outputPath` value should be the absolute path in your local machine to the Javascript folder in elentra-me codebase.

To run your code locally for development run webpack with the following command -
```
npm run start
```
This will make webpack watch for changes in your local directory and automatically build and output a new `visual-summary.js` file whenever a file in the `src` folder is changed/saved. 
## Creating a build

To create a production build. Run the following command to create a minified version of the source code.

```
npm run build
```
This will output a minified version of the `visual-summary.js` file into the linked javscript folder. 

## License

This project is licensed under the MIT License - see the [LICENSE.md](https://github.com/kiranbandi/cbd-dashboard-ui/blob/visual-summary/LICENSE) file for details